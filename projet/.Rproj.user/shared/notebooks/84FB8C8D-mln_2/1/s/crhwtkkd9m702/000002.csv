"0","xi = c(1:20)/20"
"0","xi"
"1"," [1]"
"1"," 0.05"
"1"," 0.10"
"1"," 0.15"
"1"," 0.20"
"1"," 0.25"
"1"," 0.30"
"1"," 0.35"
"1"," 0.40"
"1"," 0.45"
"1"," 0.50"
"1"," 0.55"
"1"," 0.60"
"1"," 0.65"
"1"," 0.70"
"1"," 0.75"
"1"," 0.80"
"1"," 0.85"
"1"," 0.90"
"1"," 0.95"
"1"," 1.00"
"1","
"
"0","y<-function(x){"
"0","  2*exp(-x)+1/10/x"
"0","}"
"0","yi = y(xi)"
"0","yi"
"1"," [1]"
"1"," 3.9024588"
"1"," 2.8096748"
"1"," 2.3880826"
"1"," 2.1374615"
"1"," 1.9576016"
"1"," 1.8149698"
"1"," 1.6950905"
"1"," 1.5906401"
"1"," 1.4974785"
"1"," 1.4130613"
"1"," 1.3357178"
"1"," 1.2642899"
"1"," 1.1979377"
"1"," 1.1360278"
"1","
"
"1","[15]"
"1"," 1.0780664"
"1"," 1.0236579"
"1"," 0.9724769"
"1"," 0.9242504"
"1"," 0.8787452"
"1"," 0.8357589"
"1","
"
"0","f<-function(x){"
"0","  a = x[1]"
"0","  b = x[2]"
"0","  res = 0"
"0","  for (i in 1:20){"
"0","    res = res+(yi[i]-a*exp(b*xi[i]))^2"
"0","  }"
"0","  res"
"0","}"
"0",""
"0",""
"0","dfa<-function(x){"
"0","  a = x[1]"
"0","  b = x[2]"
"0","  sum(-2*exp(b*xi)*(yi-a*exp(b*xi)))"
"0","}"
"0",""
"0","dfb<-function(x){"
"0","  a = x[1]"
"0","  b = x[2]"
"0","  sum(-2*a*xi*exp(b*xi)*(yi-a*exp(b*xi)))"
"0","}"
"0",""
"0",""
"0","x0 = c(1,1)"
"0",""
"0","delta = 0.01"
"0",""
"0","grad = c(dfa(x0),dfb(x0))"
"0",""
"0","z = rbinom(20000, 1, 0.5)"
"0",""
"0","i = 0"
"0","while(i<20000){"
"0","  i = i+1"
"0","  if (z[i]==0){"
"0","    x0 = x0-delta*c(dfa(x0),0)"
"0","  }"
"0","  else{"
"0","    x0 = x0-delta*c(0,dfb(x0))"
"0","  }"
"0","}"
"0",""
"0","x0[1] #a"
"1","[1]"
"1"," 3.373524"
"1","
"
"0","x0[2] #b"
"1","[1]"
"1"," -1.663694"
"1","
"
"0","f(x0)"
"1","[1]"
"1"," 1.135992"
"1","
"
