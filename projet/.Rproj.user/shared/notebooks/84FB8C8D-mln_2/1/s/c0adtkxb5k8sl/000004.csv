"0","rm(list=ls())"
"0",""
"0","N = 100"
"0","x_i = seq(1,N)"
"0",""
"0","y_i = c()"
"0","for (i in 1:N) { y_i[i] = (2*x_i[i])+(i/(1+i)) }"
"0",""
"0","f<-function(X){"
"0","  x = X[1]"
"0","  a = X[2]"
"0","  b = X[3]"
"0","  c = X[4]"
"0","  "
"0","  a*x+sin(b*x)+cos(c*x)"
"0","}"
"0",""
"0","dfa<-function(X){"
"0","  x = X[1]"
"0","  a = X[2]"
"0","  b = X[3]"
"0","  c = X[4]"
"0","  "
"0","  res = x"
"0","  res"
"0","}"
"0",""
"0","dfb<-function(X){"
"0","  x = X[1]"
"0","  a = X[2]"
"0","  b = X[3]"
"0","  c = X[4]"
"0","  "
"0","  res = x * cos(b*x)"
"0","  res"
"0","}"
"0",""
"0","dfc<-function(X){"
"0","  x = X[1]"
"0","  a = X[2]"
"0","  b = X[3]"
"0","  c = X[4]"
"0","  "
"0","  res = (-x)*sin(c*x)"
"0","  res"
"0","}"
"0",""
"0","A<-function(X){"
"0","  a = X[1]"
"0","  b = X[2]"
"0","  c = X[3]"
"0","  "
"0","  res = matrix(0, nrow = N, ncol = 3)"
"0","  for (i in (1:N)){"
"0","    res[i,1] = dfa(c(x_i[i],a,b,c))"
"0","    res[i,2] = dfb(c(x_i[i],a,b,c))"
"0","    res[i,3] = dfc(c(x_i[i],a,b,c))"
"0","  }"
"0","  return(res)"
"0","}"
"0",""
"0","tAA<-function(X){ t(A(X)) %*% A(X) }"
"0",""
"0","invtAAtA<-function(X){ solve(tAA(X)) %*% t(A(X)) }"
"0",""
"0","Ytilde<-function(X){"
"0","  # res = matrix(0, nrow=N, ncol=1)"
"0","  res = rep(0,N)"
"0","  for (i in (1:N)){"
"0","    res[i] = y_i[i] -f(c(x_i[i],X[1],X[2], X[3]))"
"0","  }"
"0","  res"
"0","}"
"0",""
"0","library(Matrix)"
"2","
Attachement du package : ‘Matrix’

"
"2","Les objets suivants sont masqués depuis ‘package:pracma’:

    expm, lu, tril, triu

"
"0","azerobzeroczero = c(2,1,1)"
"0",""
"0","sommecarree<-function(X){"
"0","  a = X[1]"
"0","  b = X[2]"
"0","  c = X[3]"
"0","  res = 0"
"0","  for (i in (1:100)) {"
"0","    res = res+(yi[i]-f(c(xi[i],a,b,c)))**2"
"0","    }"
"0","  res"
"0","  }"
"0",""
"0","determinants = c()"
"0","smc = c()"
"0",""
"0","j = 0"
"0","max_op = 10000"
"0","while (j<max_op) {"
"0","  j = j+1"
"0","  "
"0","  h0k0l0 = invtAAtA(azerobzeroczero) %*% Ytilde(azerobzeroczero)"
"0","  "
"0","  azerobzeroczero = azerobzeroczero+h0k0l0"
"0","  "
"0","  determinants[j] = det(t(A(azerobzeroczero)) %*% A(azerobzeroczero))"
"0","  "
"0","  m = matrix(data=NA, ncol=2, nrow=N)"
"0","  colnames(m) = c(""yi_observe"",""yi_predit"")"
"0","  for (i in c(1:N)) {"
"0","    m[i,""yi_observe""] = y_i[i]"
"0","    m[i,""yi_predit""] = f(c(x_i[i], azerobzeroczero))"
"0","  }"
"0","  "
"0","  smc[j] = (colSums(m)[1]-colSums(m)[2])^2"
"0","}"
"0",""
"0","print(""Verification si toutes les matrices t(A(a_b_c)) %*% A(a_b_c) etaient bien inversibles :"")"
"1","[1]"
"1"," ""Verification si toutes les matrices t(A(a_b_c)) %*% A(a_b_c) etaient bien inversibles :"""
"1","
"
"0","!(0 %in% determinants)"
"1","[1]"
"1"," TRUE"
"1","
"
"0","print(""Sommes des moindres carres pour chaque algorithme :"")"
"1","[1]"
"1"," ""Sommes des moindres carres pour chaque algorithme :"""
"1","
"
"0","head(smc)"
"1","[1]"
"1"," 448.1361"
"1"," 472.0243"
"1"," 468.9594"
"1"," 468.1696"
"1"," 467.2958"
"1"," 466.4028"
"1","
"
"0","# comparaison y_i observes avec y_i predits :"
"0","m = matrix(data=NA, ncol=2, nrow=N)"
"0",""
"0","colnames(m) = c(""yi_observe"",""yi_predit"")"
"0",""
"0","for (i in c(1:N)) {"
"0","  m[i,""yi_observe""] = y_i[i]"
"0","  m[i,""yi_predit""] = f(c(x_i[i], azerobzeroczero))"
"0","}"
"0",""
"0","summary(m)"
"1",""
"1","   yi_observe    "
"1","   yi_predit      "
"1","
"
"1"," Min.   :  2.50  "
"1"," Min.   :  3.372  "
"1","
"
"1"," 1st Qu.: 52.46  "
"1"," 1st Qu.: 52.603  "
"1","
"
"1"," Median :101.98  "
"1"," Median :101.983  "
"1","
"
"1"," Mean   :101.96  "
"1"," Mean   :101.747  "
"1","
"
"1"," 3rd Qu.:151.49  "
"1"," 3rd Qu.:151.534  "
"1","
"
"1"," Max.   :200.99  "
"1"," Max.   :201.329  "
"1","
"
"0","print(paste(""Le modele est approxime par la fonction suivante :"","
"0","            ""f(x,a,b,c) = a*x + sin(b*x) + cos(c*x) ="","
"0","            azerobzeroczero[1], ""*x + sin("", azerobzeroczero[2], ""*x) + cos("", azerobzeroczero[3], ""*x)""))"
"1","[1]"
"1"," ""Le modele est approxime par la fonction suivante : f(x,a,b,c) = a*x + sin(b*x) + cos(c*x) = 2.014867057064 *x + sin( 1.01501139373845 *x) + cos( 1.0385924636852 *x)"""
"1","
"
