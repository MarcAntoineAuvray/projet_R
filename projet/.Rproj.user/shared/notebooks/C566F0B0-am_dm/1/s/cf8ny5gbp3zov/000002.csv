"0","MLM<-function(df){"
"0","  # pour chaque nom de colonne dans les noms de colonnes de df"
"0","  for (nom_colonne in colnames(df)) {"
"0","    "
"0","    # on affiche ce nom"
"0","    print(paste(""Y :"", nom_colonne))"
"0","    "
"0","    # on met dans un dataframe data, en colonne ""Y"" cette colonne, "
"0","    # et les autres colonnes"
"0","    data = data.frame(""Y"" = df[, nom_colonne],"
"0","                      df[, names(df) != nom_colonne])"
"0","    "
"0","    # on met dans model un modele lineair multiple de Y,"
"0","    # en fonction des autres colonnes "
"0","    model <- lm(Y ~ ., "
"0","                data = data)"
"0","    "
"0","    # step permet de refaire le modele lineaire plusieurs fois"
"0","    # en supprimant  a chaque fois la colonne la moins explicative."
"0","    # suppressWarnings evite l afficha de Warnings"
"0","    # trace permet d afficher le modele lineaire a chaque fois"
"0","    suppressWarnings( {step = step(model, "
"0","                                   direction = ""backward"", "
"0","                                   trace = TRUE)} )"
"0","    "
"0","    print(""Modele final (comparaison summary(model)/equation) :"")"
"0","    "
"0","    # SCR : calcul de la Sum of Squared Residuals de chaque step"
"0","    SCR = sum((step$fitted-data$Y)^2)"
"0","    # n : longueur de Y"
"0","    n = length(data$Y)"
"0","    # p : nombre de variables explicatives -1"
"0","    p = length(step$coef)-1"
"0","    # X : matrice avec une premiere colonne de 1 (il y en a un nombre n),"
"0","    # et les colonnes explicatives"
"0","    X = as.matrix(cbind(rep(1, length(data$Y)),"
"0","                        data[names(step$coefficients[-1])]))"
"0","    "
"0","    print(""Variables explicatives gardees :"")"
"0","    print(names(step$coefficients[-1]))"
"0","  "
"0","    print(""Estimation des variances des variables explicatives :"")"
"0","    print(summary(step)[[4]][,2])"
"0","    print(sqrt(diag(SCR/(n-p-1)*ginv(t(X)%*%X))))"
"0","    "
"0","    print(""Estimation de la statistique T des variables explicatives :"")"
"0","    print(summary(step)[[4]][,3])"
"0","    print(step$coef/sqrt(diag(vcov(step))))"
"0","    "
"0","    print(""Sigma :"")"
"0","    print(summary(step)[6])"
"0","    print(sqrt(sum(step$res^2)/(n-p-1)))"
"0","    "
"0","    print(""Multiple R-squared :"")"
"0","    print(summary(step)[8])"
"0","    SCT = sum((mean(data$Y)-data$Y)^2)"
"0","    R2 = 1-(SCR/SCT)"
"0","    print(R2)"
"0","    "
"0","    print(""Adjusted R-squared :"")"
"0","    print(summary(step)[9])"
"0","    print(1-(1-R2)*(n-1)/(n-p-1))"
"0","    "
"0","    print(""Fstatistic"")"
"0","    print(summary(step)[10])"
"0","    print(((SCT-SCR)/p)/(SCR/(n-p-1)))"
"0","    "
"0","    print(""------------------------------------------------"")"
"0","    }"
"0","}"
