"0","acp_<-function(X, min_info=85) {"
"0","  # pour chaque nombre de composantes principales (ncp) possible"
"0","  # entre 2 et jusqu au nombre de colonnes de X"
"0","  for (ncp in (2:(dim(X)[2]))){"
"0","    "
"0","    print(""Nombre de dimensions :"")"
"0","    print(ncp)"
"0","    "
"0","    # dans PCA on met une PCA avec :"
"0","    #  en donnees X,"
"0","    #  en nombre de composantes principales ncp,"
"0","    #  en scales.unit TRUE, ce qui centre et reduit les donnees "
"0","    #  en graph FALSE, ce qui desactive la production de graphique "
"0","    PCA = PCA(X=X, "
"0","              ncp=ncp,"
"0","              scale.unit=TRUE,"
"0","              graph=FALSE)"
"0","    "
"0","    # on l affiche"
"0","    PCA"
"0","    "
"0","    # on en affiche un resume"
"0","    summary(PCA)"
"0","  "
"0","    print(""Extraction des valeurs propres / variances des composantes principales :"")"
"0","    eig_val = get_eigenvalue(PCA)"
"0","    print(eig_val)"
"0","    print(paste(""Dimensions qui gardent au moins le minimum d information ("", "
"0","                min_info, ""% de variance cumulee) : ""))"
"0","    print(get_eigenvalue(PCA)[,3]>min_info)"
"0","    "
"0","    print(""Extraction des résultats pour les individus :"")"
"0","    print(get_pca_ind(PCA))"
"0","    "
"0","    print(""Extraction des résultats pour les variables :"")"
"0","    print(get_pca_var(PCA))"
"0","    "
"0","    print(""----------------------------------------------------------------------------------------------------------"")"
"0","  }"
"0","  "
"0","  # on affiche la representation graphique de l ACP c est a dire :"
"0","  #  un graphique de projection des individus dans le plan forme"
"0","  #   par les 2 premieres composantes principales"
"0","  plot(PCA)"
"0","  "
"0","  print(""Visualisation des valeurs propres :"")"
"0","  print(fviz_eig(PCA))"
"0","  "
"0","  print(""visualisation des résultats des individus :"")"
"0","  fviz_pca_ind(PCA)"
"0","  "
"0","  print(""visualisation des résultats des variables :"")"
"0","  fviz_pca_var(PCA)"
"0","  "
"0","  print(""Biplot des individus et des variables :"")"
"0","  # on privilegie fviz_pca_biplota biplot, "
"0","  # car  plus adaptee pour les resultats d une ACP"
"0","  fviz_pca_biplot(PCA)"
"0","  "
"0","  ncp = which(get_eigenvalue(PCA)[,3] > min_info)[1] "
"0","  # nombre de dimensions qui gardent le min d info qu on voulait"
"0","  "
"0","  print(paste(""Nombre de dimensions a garder pour garder "", "
"0","              ncp, "
"0","              ""% de variance cumulee""))"
"0","  "
"0","  prcomp = prcomp(X)"
"0","  "
"0","  print(""Déviations standardes des composantes principales (ordre décroissant)"")"
"0","  print(""Et matrice des corrélations entre les composantes principales et les variables originales :"")"
"0","  prcomp"
"0","  "
"0","  print(""Importance des composantes principales en termes de déviation standard et de proportion de variance. "
"0","        La proportion de variance est le pourcentage de la variance totale du jeu de données qui est expliqué par chaque composante principale. "
"0","        La proportion cumulative est la somme cumulative des proportions de variance : "")"
"0","  summary(prcomp)"
"0","}"
"0",""
