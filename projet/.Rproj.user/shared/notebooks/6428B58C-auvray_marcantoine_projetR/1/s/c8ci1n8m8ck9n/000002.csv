"0","ajouter_colonnes_quantile <- function(df, nombre_categories, nom_colonne_categories="""", nom_colonne_moyennes="""") {"
"0","  "
"0","  if(nom_colonne_categories==""""){"
"0","    nom_colonne_categories = paste0(""quantile_dordre_"", as.character(nombre_categories), ""_numeros_categories"")"
"0","    "
"0","  }"
"0","  if(nom_colonne_moyennes==""""){"
"0","    nom_colonne_moyennes = paste0(""quantile_dordre_"", as.character(3), ""_moyennes"")"
"0","  }"
"0","  "
"0","  noms_colonnes = c(nom_colonne_categories, nom_colonne_moyennes)"
"0","  df[[nom_colonne_categories]] = cut(df$prix, breaks = quantile(df$prix, probs=seq(0, 1, 1/nombre_categories)), labels=1:nombre_categories, include.lowest=TRUE)"
"0","  "
"0","  df[[nom_colonne_moyennes]] = rep(NA, nrow(df))"
"0","  "
"0","  for (i in 1:nombre_categories) {"
"0","    df[[nom_colonne_moyennes]][df[[nom_colonne_categories]] == i] = mean(df$prix[df[[nom_colonne_categories]] == i], na.rm=TRUE)"
"0","  }"
"0","  return(df)"
"0","}"
"0",""
"0",""
"0","liste_quantiles = list(nombres = c(2,4,10),"
"0","                       noms_colonne_categories = c(""mediane_numeros_categories"",""quartile_numeros_categories"", ""decile_numeros_categories""),"
"0","                       noms_colonne_moyennes = c(""mediane_moyennes"",""quartile_moyennes"", ""decile_moyennes""))"
"0","for (i in 1:length(liste_quantiles)) {"
"0","  df = ajouter_colonnes_quantile(df=df, "
"0","                                 nombre_categories=liste_quantiles$nombres[i],"
"0","                                 nom_colonne_categories=liste_quantiles$noms_colonne_categories[i],"
"0","                                 nom_colonne_moyennes=liste_quantiles$noms_colonne_moyennes[i])"
"0","}"
"0",""
"0","View(df)"
