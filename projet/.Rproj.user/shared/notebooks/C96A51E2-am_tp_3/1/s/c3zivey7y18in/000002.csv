"0","# Algorithme EM melange de deux gaussiennes dans un cadre unidimensionnel"
"0",""
"0","# (version 2)"
"0",""
"0","## Definition arbitraire des valeurs initiales des parametres :"
"0",""
"0","lambda1 = 0.2"
"0","lambda2 = 0.8"
"0",""
"0","mu1 = 110"
"0","mu2 = 170"
"0",""
"0","sigma1 = 5"
"0","sigma2 = 5"
"0",""
"0","K = 30 # on fera K iterations de lâ€™algorithme"
"0","for (i in 1:K) {"
"0","  ## Application de la formule (28) :"
"0","  vrais1 = lambda1*dnorm(X, mean=mu1, sd=sigma1)"
"0","  vrais2 = lambda2*dnorm(X, mean=mu2, sd=sigma2)"
"0","  "
"0","  vrais12 = vrais1 / (vrais1 + vrais2) # probas a posteriori p_{i,1}"
"0","  vrais22 = vrais2 / (vrais1 + vrais2) # probas a posteriori p_{i,2}"
"0","  "
"0","  ## Mise a jour de lambda1 = P(Z=1 | X,Theta) :"
"0","  lambda1 = mean(vrais12)"
"0","  lambda2 = 1-lambda1"
"0","  "
"0","  ## Mise a jour de mu1 et mu2 :"
"0","  mu1 = sum(vrais12*X)/sum(vrais12)"
"0","  mu2 = sum(vrais22*X)/sum(vrais22)"
"0","  "
"0","  ## Mise a jour de sigma1 et sigma2 :"
"0","  sigma1 = sqrt(sum(vrais12*(X-mu1)^2)/(sum(vrais12)))"
"0","  sigma2 = sqrt(sum(vrais22*(X-mu2)^2)/(sum(vrais22)))"
"0","}"
"0",""
"0","# hist(X, nc=30, freq=FALSE)"
"0","# x = seq(range(X)[1], range(X)[2], length=200)"
"0","# lines(x, p*dnorm(x, mean=mu1, sd=sigma1), col=""blue"", lwd=2)"
"0","# lines(x, (1-p)*dnorm(x, mean=mu2, sd=sigma2), col=""red"", lwd=2)"
