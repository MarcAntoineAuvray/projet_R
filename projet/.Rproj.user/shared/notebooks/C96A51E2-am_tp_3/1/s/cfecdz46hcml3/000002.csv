"0","# Code-EM-Melange-de-deux-Gaussiennes-unidim-version2"
"0",""
"0","n = 1000"
"0",""
"0","mu1 = -3"
"0","mu2 = 3"
"0",""
"0","sig1 = 1.2"
"0","sig2 = 0.8"
"0",""
"0","alpha1 = 1/3"
"0","alpha2 = 1-alpha1"
"0",""
"0","X1 = rnorm(n, mu1, sig1)"
"0","X2 = rnorm(n, mu2, sig2)"
"0",""
"0","Z = rbinom(n, 1, alpha)"
"0",""
"0","X = Z*X1+(1-Z)*X2"
"0",""
"0","# Code EM"
"0",""
"0","n = 1000"
"0",""
"0","alpha1 = 1/2"
"0","alpha2 = 1-alpha1"
"0",""
"0","mu1 = 1"
"0","mu2 = -1"
"0",""
"0","sigma1 = 1"
"0","sigma2 = 0.6"
"0",""
"0","for (l in 1:200) {"
"0","  # print(c(l, mu1, sigma1, mu2, sigma2))"
"0","  vrais1 = alpha1*dnorm(X, mean=mu1, sd=sigma1)"
"0","  vrais2 = alpha2*dnorm(X, mean=mu2,sd=sigma2)"
"0","  vrais11 = vrais1 / (vrais1 + vrais2)"
"0","  vrais21 = vrais2 / (vrais1 + vrais2)"
"0","  alpha1 = (1/n)*sum(vrais11)"
"0","  alpha2 = 1-alpha1"
"0","  # print(l)"
"0","  mu1 = sum(vrais11*X)/sum(vrais11)"
"0","  # print(mu1)"
"0","  mu2 = sum(vrais21*X)/sum(vrais21)"
"0","  # print(mu2)"
"0","  sigma1 = sqrt(sum(vrais11*(X-mu1)^2)/sum(vrais11))"
"0","  sigma2 = sqrt(sum(vrais21*(X-mu2)^2)/sum(vrais21))"
"0","  # print(sigma1)"
"0","}"
