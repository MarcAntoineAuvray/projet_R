"0","# Code de l’algorithme EM pour un melange de trois gaussiennnes bidimensionnelles"
"0",""
"0","# library(emdbook)"
"0","# "
"0","# n=1000"
"0","# alpha=c(runif(1),runif(1),runif(1))"
"0","# sigma1=matrix(nrow=2,ncol=2)"
"0","# sigma2=matrix(nrow=2,ncol=2)"
"0","# sigma3=matrix(nrow=2,ncol=2)"
"0","# mu1=c(runif(1),runif(1))"
"0","# mu2=c(runif(1),runif(1))"
"0","# mu3=c(runif(1),runif(1))"
"0","# sigma1[1,1]=runif(1)"
"0","# sigma1[2,2]=runif(1)"
"0","# sigma2[1,1]=runif(1)"
"0","# sigma2[2,2]=runif(1)"
"0","# sigma3[1,1]=runif(1)"
"0","# sigma3[2,2]=runif(1)"
"0","# sigma1[1,2]=0"
"0","# sigma1[2,1]=0"
"0","# sigma2[1,2]=0"
"0","# sigma2[2,1]=0"
"0","# sigma3[1,2]=0"
"0","# sigma3[2,1]=0"
"0","# "
"0","# for (l in 1:1000) {"
"0","#   vrais1 = alpha[1] * dmvnorm(X, mu=mu1, Sigma=sigma1)"
"0","#   vrais2 = alpha[2] * dmvnorm(X, mu=mu2, Sigma=sigma2)"
"0","#   vrais3 = alpha[3] * dmvnorm(X, mu=mu3, Sigma=sigma3)"
"0","# "
"0","#   vrais11 = vrais1 / (vrais1 + vrais2 + vrais3)"
"0","#   vrais21 = vrais2 / (vrais1 + vrais2 + vrais3)"
"0","#   vrais31 = vrais3 / (vrais1 + vrais2 + vrais3)"
"0","# "
"0","#   alpha[1] = (1/n) * sum(vrais11)"
"0","#   alpha[2] = (1/n) * sum(vrais21)"
"0","#   alpha[3] = (1/n) * sum(vrais31)"
"0","# "
"0","#   mu1 = colSums(vrais11%*%X)/sum(vrais11)"
"0","#   mu2 = colSums(vrais21%*%X)/sum(vrais21)"
"0","#   mu3 = colSums(vrais31%*%X)/sum(vrais31)"
"0","# "
"0","#   P1 = diag(((t(X-mu1)%*%sqrt(vrais11)%*%sqrt(t(vrais11))%*%(X-mu1))))"
"0","# "
"0","#   sigma1[1,1] = sqrt(P1[1])/(sum(vrais11))"
"0","#   sigma1[2,2] = sqrt(P1[2])/(sum(vrais11))"
"0","# "
"0","#   P2 = diag(((t(X-mu2)%*%sqrt(vrais21)%*%sqrt(t(vrais21))%*%(X-mu2))))"
"0","# "
"0","#   sigma2[1,1] = sqrt(P2[1])/(sum(vrais21))"
"0","#   sigma2[2,2] = sqrt(P2[2])/(sum(vrais21))"
"0","# "
"0","#   P3 = diag(((t(X-mu3)%*%sqrt(vrais31)%*%sqrt(t(vrais31))%*%(X-mu3))))"
"0","# "
"0","#   sigma3[1,1] = sqrt(P3[1])/(sum(vrais31))"
"0","#   sigma3[2,2] = sqrt(P3[2])/(sum(vrais31))"
"0","# }"
"0","# "
"0","# # et pour afficher notre nuage de point avec les nouveaux parametres"
"0","# X1 = rmvnorm(n=n, mean=mu1, sigma=sigma1)"
"0","# X2 = rmvnorm(n=n, mean=mu2, sigma=sigma2)"
"0","# X3 = rmvnorm(n=n, mean=mu3, sigma=sigma3)"
"0","# "
"0","# W = rbinom(n, 1, alpha[1])"
"0","# "
"0","# Z = rbinom(n, 1, alpha[2]*(1/(1-alpha[1])))"
"0","# "
"0","# F_ = W*X1+(1-W)*(Z*X2+(1-Z)*X3)"
"0","# "
"0","# plot(F_, xlab=""x"" ,ylab=""y"","
"0","#      main=""Apres 1000 iterations de l’EM"", col=""red"")"
