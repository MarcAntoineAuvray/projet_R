"0",""
"0",""
"0","# Code EM"
"0",""
"0","n = 1000"
"0",""
"0","alpha = c(1/2,1/2)"
"0",""
"0","mu1 = c(1,1)"
"0","mu2 = c(5,5)"
"0",""
"0","sigma1 = matrix(nrow=2, ncol=2)"
"0","sigma1[1,2] = 0"
"0","sigma1[2,1] = 0"
"0","sigma1[1,1] = 2/3"
"0","sigma1[2,2] = 2/3"
"0",""
"0","sigma2 = matrix(nrow=2, ncol=2)"
"0","sigma2[1,2] = 0"
"0","sigma2[2,1] = 0"
"0","sigma2[1,1] = 1.5"
"0","sigma2[2,2] = 1.5"
"0",""
"0","library(emdbook)"
"0",""
"0","for (l in 1:10000) {"
"0","  vrais1 = alpha[1]*dmvnorm(X, mu=mu1, Sigma=sigma1)"
"0","  vrais2 = alpha[2]*dmvnorm(X, mu=mu2, Sigma=sigma2)"
"0","  vrais11 = vrais1 / (vrais1 + vrais2)"
"0","  vrais21 = vrais2 / (vrais1 + vrais2)"
"0","  alpha[1] = (1/n)*sum(vrais11)"
"0","  alpha[2] = (1/n)*sum(vrais21)"
"0","  #print(l)"
"0","  mu1 = colSums(vrais11%*%X)/sum(vrais11)"
"0","  #print(mu1)"
"0","  mu2 = colSums(vrais21%*%X)/sum(vrais21)"
"0","  #print(mu2)"
"0","  P1 = diag(((t(X-mu1)%*%sqrt(vrais11)%*%sqrt(t(vrais11))%*%(X-mu1))))"
"0","  sigma1[1,1] = sqrt(P1[1])/(sum(vrais11))"
"0","  sigma1[2,2] = sqrt(P1[2])/(sum(vrais11))"
"0","  #print(sigma1)"
"0","  P2 = diag(((t(X-mu2)%*%sqrt(vrais21)%*%sqrt(t(vrais21))%*%(X-mu2))))"
"0","  sigma2[1,1] = sqrt(P2[1])/(sum(vrais21))"
"0","  sigma2[2,2] = sqrt(P2[2])/(sum(vrais21))"
"0","  #print(sigma2)"
"0","  }"
