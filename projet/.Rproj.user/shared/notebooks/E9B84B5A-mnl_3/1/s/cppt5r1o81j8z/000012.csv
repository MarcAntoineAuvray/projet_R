"0","rm(list=ls())"
"0",""
"0","a = -1"
"0",""
"0","b = 2"
"0",""
"0","N = 6"
"0",""
"0","alpha = 1"
"0",""
"0","x_i = c()"
"0","y_i = c()"
"0",""
"0","for (i in 1:N) {"
"0","  x_i[i] = i/N+1"
"0","  y_i[i] = ((-1)^i) * sqrt(N+1)"
"0","  }"
"0",""
"0","h_i = x_i[2:N]-x_i[1:N-1]"
"0",""
"0","Q = matrix(data=0, nrow=N, ncol=N-2)"
"0",""
"0","for (i in c(1:(N-2))) {"
"0","  Q[i,i] = 1/(h_i[i])"
"0","  Q[i+1,i] = (-1/(h_i[i])) - (1/(h_i[i+1]))"
"0","  Q[i+2,i] = 1/(h_i[i+1])"
"0","}"
"0",""
"0","R = matrix(data = 0, nrow=N-2, ncol=N-2)"
"0",""
"0","for (i in (1:(N-2))) {"
"0","  R[i,i]= (h_i[i]+h_i[i+1])/3"
"0","  if(i<4){"
"0","    R[i+1,i] = h_i[i+1]/6"
"0","    R[i,i+1] = h_i[i+1]/6"
"0","  }"
"0","}"
"0",""
"0","R_plus_alpha_tQ_Q = R + (alpha*(t(Q) %*% Q))"
"0",""
"0","Gamma = solve(R_plus_alpha_tQ_Q) %*%t(Q) %*% y_i"
"0",""
"0","G = y_i - (alpha*Q%*%Gamma)"
"0",""
"0","g_prime_x1 = ((G[2]-G[1])/h_i[1]) - ((h_i[1]/6) * (Gamma[1]))"
"0",""
"0","g_prime_xN = ((G[N]-G[N-1])/h_i[N-1]) + ((h_i[N-1]/6) * (Gamma[N-2]))"
"0",""
"0","g<-function(x){"
"0","  res <- 0"
"0","  for (i in (1:(N-1))){"
"0","    if((x>x_i[i]) & (x<=x_i[i+1])) {"
"0","      if(i==1){"
"0","        res <- (G[i]*(x_i[i+1]-x)+G[i+1]*(x-x_i[i]))/h_i[i] + (x-x_i[i])*(x-x_i[i+1])*((1+(x-x_i[i])/h_i[i])*Gamma[1])/6"
"0","      } else {"
"0","        if(i==(N-1)) {"
"0","          res <- ((-G[i]*(x-x_i[i+1])+G[i+1]*(x-x_i[i]))/h_i[i]) +((x-x_i[i])*(x-x_i[i+1])*((1+(x_i[i+1]-x)/h_i[i])*Gamma[N-2])/6)"
"0","          } else {"
"0","              res <- ((G[i]*(x_i[i+1]-x)+G[i+1]*(x-x_i[i]))/h_i[i])+ ((x-x_i[i])*(x-x_i[i+1])*(((1+((x-x_i[i]) /h_i[i]))*Gamma[i] +((1+(x_i[i+1]-x)/h_i[i])*Gamma[i-1]))/6))"
"0","              "
"0","              }"
"0","                                                                      "
"0","      }"
"0","    }"
"0","  }"
"0","  if(x<=x_i[1]){"
"0","    res <- G[1]+g_prime_x1*(x-x_i[1])"
"0","  }"
"0","  if(x>x_i[N]){"
"0","    res <- G[N]+g_prime_xN*(x-x_i[N])"
"0","  }"
"0","  res"
"0","}"
"0",""
"0","pas = 0.1"
"0","x = seq(a,b,pas)"
"0","N_ = as.integer((b-a)/pas)"
"0",""
"0","y <- rep(0,N+1)"
"0","for (j in (1:(N_+1))){"
"0","  y[j] <- g(x[j])"
"0","}"
"0",""
"0","# par(mar = c(1, 1, 1, 1))  "
"0","# pdf(""Spline1.pdf"")"
"0","plot(x,y,type=""l"", col = ""red"")"
